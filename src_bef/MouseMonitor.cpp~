/*
  get from http://www.nakatayuki.com/archives/1061180296.html
 */

#include <stdio.h>
#include <stdlib.h>
#include <linux/input.h>
#include <unistd.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>

int keyboardfd;
int mousefd;

int main(void)
{
  mousefd = open("/dev/input/event15", O_RDWR);
  keyboardfd = open("/dev/input/event1", O_RDWR);
	
  for (;;) {
    struct input_event event;

    if (read(mousefd, &event, sizeof(event)) != sizeof(event)) {
      exit(EXIT_FAILURE);
    }
    switch(event.type) {
      case EV_KEY:
	printf("EV_KEY code:%x  value:%x\n", event.code, event.value);		
        break;
      case EV_REL:
	printf("EV_REL rel:%x value:%x\n ", event.code,event.value);	
	break;
      case EV_ABS:
	//printf("abs:%x  ", event.code);	
	break;
    case EV_SYN: {
      printf("SYN syn:%x value%x\n",event.code,event.value);
      break;
    }
      default:
				 
        break;
    }
    fflush(stdout);
  }
  
  close(keyboardfd);
  close(mousefd);
}
